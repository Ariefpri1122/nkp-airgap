{"status":{},"spec":{"name":"Private_Mirror","description":"","resources":{"service_definition_list":[{"name":"Mirror","description":"","variable_list":[],"action_list":[{"type":"system","name":"action_create","description":"System action for creating an application","runbook":{"name":"3167369a_runbook","description":"","task_definition_list":[{"type":"DAG","name":"4913e80f_dag","description":"","attrs":{"type":"","edges":[{"type":"","from_task_reference":{"name":"Permissive","kind":"app_task"},"to_task_reference":{"name":"Disable Module","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Disable Module","kind":"app_task"},"to_task_reference":{"name":"Install Tools","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Install Tools","kind":"app_task"},"to_task_reference":{"name":"Install Docker CE","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Docker Registry","kind":"app_task"},"to_task_reference":{"name":"Restart VM","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Install Docker CE","kind":"app_task"},"to_task_reference":{"name":"Docker Registry","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Restart VM","kind":"app_task"},"to_task_reference":{"name":"Start Docker Registry","kind":"app_task"},"edge_type":"user_defined"}]},"child_tasks_local_reference_list":[{"name":"Permissive","kind":"app_task"},{"name":"Disable Module","kind":"app_task"},{"name":"Install Tools","kind":"app_task"},{"name":"Install Docker CE","kind":"app_task"},{"name":"Docker Registry","kind":"app_task"},{"name":"Restart VM","kind":"app_task"},{"name":"Start Docker Registry","kind":"app_task"}],"variable_list":[],"target_any_local_reference":{"name":"Mirror","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"Permissive","description":"","attrs":{"type":"","script":"#!\/bin\/bash\n\nCONFIG_FILE=\"\/etc\/selinux\/config\"\n\n# Check if file exists\nif [ ! -f \"$CONFIG_FILE\" ]; then\n    echo \"SELinux config file not found: $CONFIG_FILE\"\n    exit 1\nfi\n\n# Use sudo to update the SELINUX line\nsudo sed -i 's\/^SELINUX=.*\/SELINUX=permissive\/' \"$CONFIG_FILE\"\n\n# Show result using sudo\nsudo grep \"^SELINUX=\" \"$CONFIG_FILE\"\n","script_type":"sh","command_line_args":"","exit_status":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Mirror","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"Disable Module","description":"","attrs":{"type":"","script":"sudo ethtool --offload ens3 rx-gro-hw off","script_type":"sh","command_line_args":"","exit_status":[],"login_credential_local_reference":{"name":"nutanix","kind":"app_credential"}},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Mirror","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"Install Tools","description":"","attrs":{"type":"","script":"sudo yum install -y curl wget tar zip tmux git ","script_type":"sh","command_line_args":"","exit_status":[],"login_credential_local_reference":{"name":"nutanix","kind":"app_credential"}},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Mirror","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"Install Docker CE","description":"","attrs":{"type":"","script":"sudo dnf config-manager --add-repo https:\/\/download.docker.com\/linux\/rhel\/docker-ce.repo && \\\nsudo dnf -y install docker-ce docker-ce-cli containerd.io && \\\nsudo systemctl --now enable docker && \\\nsudo systemctl start docker && \\\nsudo usermod -aG docker nutanix","script_type":"sh","command_line_args":"","exit_status":[],"login_credential_local_reference":{"name":"nutanix","kind":"app_credential"}},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Mirror","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"Docker Registry","description":"","attrs":{"type":"","script":"sudo docker login -u ariefpri1122 -p nutanix\/4u\ndocker login -u ariefpri1122 -p nutanix\/4u\n\nmkdir -p certs auth && \\\ndocker run --rm --entrypoint htpasswd xmartlabs\/htpasswd -Bbn \"admin\" \"nutanix\/4u\" | tee auth\/htpasswd && \\\nopenssl req -newkey rsa:4096 -nodes -sha256 -keyout certs\/domain.key -x509 -days 365 -out certs\/domain.crt -subj \"\/C=ID\/ST=Indonesia\/L=Jakarta\/O=Nutanix\/OU=IT\/CN=*.@@{Domain_Name}@@\" -addext \"subjectAltName = DNS:*.@@{Domain_Name}@@\"\n\nsudo mkdir -p \/mnt\/registry \nsudo chown -R root:docker .\/certs .\/auth \/mnt\/registry\nsudo chmod -R 755 .\/certs .\/auth \/mnt\/registry\n\nsudo docker run -d -p 5000:5000 \\\n--restart=always \\\n--name DockerRegistry \\\n-v \/mnt\/registry:\/var\/lib\/registry \\\n-v $(pwd)\/auth:\/auth \\\n-e \"REGISTRY_AUTH=htpasswd\" \\\n-e \"REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm\" \\\n-e REGISTRY_AUTH_HTPASSWD_PATH=\/auth\/htpasswd \\\n-v $(pwd)\/certs:\/certs \\\n-e REGISTRY_HTTP_TLS_CERTIFICATE=\/certs\/domain.crt \\\n-e REGISTRY_HTTP_TLS_KEY=\/certs\/domain.key \\\nregistry:2\n\nsudo docker start DockerRegistry","script_type":"sh","command_line_args":"","exit_status":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Mirror","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"CALL_RUNBOOK","name":"Restart VM","description":"","attrs":{"type":"CALL_RUNBOOK","runbook_reference":{"name":"SYS_GEN__substrate__Mirror_VM__action_restart__runbook","kind":"app_runbook"},"inarg_list":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Mirror","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"Start Docker Registry","description":"","attrs":{"type":"","script":"sudo docker start DockerRegistry","script_type":"sh","command_line_args":"","exit_status":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Mirror","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"4913e80f_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"system","name":"action_delete","description":"System action for deleting an application. Deletes created VMs as well","runbook":{"name":"a1f682ef_runbook","description":"","task_definition_list":[{"type":"DAG","name":"5df7051c_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Mirror","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"5df7051c_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"system","name":"action_start","description":"System action for starting an application","runbook":{"name":"207d17ce_runbook","description":"","task_definition_list":[{"type":"DAG","name":"203a6e95_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Mirror","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"203a6e95_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"system","name":"action_stop","description":"System action for stopping an application","runbook":{"name":"2ba7d3c1_runbook","description":"","task_definition_list":[{"type":"DAG","name":"923ca482_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Mirror","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"923ca482_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"system","name":"action_restart","description":"System action for restarting an application","runbook":{"name":"fb705466_runbook","description":"","task_definition_list":[{"type":"DAG","name":"07e2fcd3_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Mirror","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"07e2fcd3_dag","kind":"app_task"},"variable_list":[]},"critical":false}],"depends_on_list":[],"port_list":[],"singleton":false,"tier":""},{"name":"Registry","description":"","variable_list":[],"action_list":[{"type":"system","name":"action_create","description":"System action for creating an application","runbook":{"name":"abfb948e_runbook","description":"","task_definition_list":[{"type":"DAG","name":"3b7775ef_dag","description":"","attrs":{"type":"","edges":[{"type":"","from_task_reference":{"name":"Permissive","kind":"app_task"},"to_task_reference":{"name":"Disable Module","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Disable Module","kind":"app_task"},"to_task_reference":{"name":"Install Tool","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Install Tool","kind":"app_task"},"to_task_reference":{"name":"Install Docker","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Install Docker","kind":"app_task"},"to_task_reference":{"name":"Nginx","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Nginx","kind":"app_task"},"to_task_reference":{"name":"Cert Copy","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Cert Copy","kind":"app_task"},"to_task_reference":{"name":"nginx_conf","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"nginx_conf","kind":"app_task"},"to_task_reference":{"name":"VM Restart","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"VM Restart","kind":"app_task"},"to_task_reference":{"name":"OSS_Config","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"OSS_Config","kind":"app_task"},"to_task_reference":{"name":"OSS service","kind":"app_task"},"edge_type":"user_defined"}]},"child_tasks_local_reference_list":[{"name":"Permissive","kind":"app_task"},{"name":"Disable Module","kind":"app_task"},{"name":"Install Tool","kind":"app_task"},{"name":"Install Docker","kind":"app_task"},{"name":"Nginx","kind":"app_task"},{"name":"Cert Copy","kind":"app_task"},{"name":"nginx_conf","kind":"app_task"},{"name":"VM Restart","kind":"app_task"},{"name":"OSS_Config","kind":"app_task"},{"name":"OSS service","kind":"app_task"}],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"Permissive","description":"","attrs":{"type":"","script":"#!\/bin\/bash\n\nCONFIG_FILE=\"\/etc\/selinux\/config\"\n\n# Check if file exists\nif [ ! -f \"$CONFIG_FILE\" ]; then\n    echo \"SELinux config file not found: $CONFIG_FILE\"\n    exit 1\nfi\n\n# Use sudo to update the SELINUX line\nsudo sed -i 's\/^SELINUX=.*\/SELINUX=permissive\/' \"$CONFIG_FILE\"\n\n# Show result using sudo\nsudo grep \"^SELINUX=\" \"$CONFIG_FILE\"\n","script_type":"sh","command_line_args":"","exit_status":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"Disable Module","description":"","attrs":{"type":"","script":"sudo ethtool --offload ens3 rx-gro-hw off","script_type":"sh","command_line_args":"","exit_status":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"Install Tool","description":"","attrs":{"type":"","script":"sudo yum install -y curl wget tar zip tmux git ","script_type":"sh","command_line_args":"","exit_status":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"Install Docker","description":"","attrs":{"type":"","script":"sudo dnf config-manager --add-repo https:\/\/download.docker.com\/linux\/rhel\/docker-ce.repo && \\\nsudo dnf -y install docker-ce docker-ce-cli containerd.io && \\\nsudo systemctl --now enable docker && \\\nsudo usermod -aG docker nutanix","script_type":"sh","command_line_args":"","exit_status":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"Nginx","description":"","attrs":{"type":"","script":"#!\/bin\/bash\n\n\n# Use SSH key auth or passwordless auth\n#scp -o StrictHostKeyChecking=no ${USERNAME}@${SOURCE_IP}:${REMOTE_PATH} ${LOCAL_PATH}\n\n# sudo dnf update -y \nsudo dnf install nginx -y\nsudo systemctl enable --now nginx\n","script_type":"sh","command_line_args":"","exit_status":[],"login_credential_local_reference":{"name":"nutanix","kind":"app_credential"}},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"Cert Copy","description":"","attrs":{"type":"","script":"#!\/bin\/bash\n\nSOURCE_IP=\"@@{Mirror.address}@@\"\n\necho \"$SOURCE_IP\"\n\n\nsudo yum install -y sshpass\nsudo mkdir -p \/etc\/nginx\/certs\nsudo sshpass -p \"nutanix\/4u\" scp -o StrictHostKeyChecking=no nutanix@${SOURCE_IP}:certs\/domain.crt \/etc\/nginx\/certs\/registry-ca.crt\nsudo sshpass -p \"nutanix\/4u\" scp -o StrictHostKeyChecking=no nutanix@${SOURCE_IP}:certs\/domain.key \/etc\/nginx\/certs\/registry-ca.key\nsudo chmod -R 777 \/etc\/nginx\/certs\/*\n\n\n","script_type":"sh","command_line_args":"","exit_status":[],"login_credential_local_reference":{"name":"nutanix","kind":"app_credential"}},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"nginx_conf","description":"","attrs":{"type":"","script":"#!\/bin\/bash\n\n# Write the NGINX config using heredoc + sudo tee\ncat << 'EOF' | sudo tee \/etc\/nginx\/nginx.conf > \/dev\/null\nevents {\n  worker_connections 1024;\n}\n\nhttp {\n  client_max_body_size 500M;\n\n  server {\n    listen 443 ssl;\n    server_name registry.@@{Domain_Name}@@;\n\n    ssl_certificate \/etc\/nginx\/certs\/registry-ca.crt;\n    ssl_certificate_key \/etc\/nginx\/certs\/registry-ca.key;\n\n    location \/ {\n        proxy_pass http:\/\/localhost:8081;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header X-Forwarded-Host $server_name;\n    }\n\n    location \/v2 {\n        proxy_pass http:\/\/localhost:8086;\n        proxy_set_header Host $http_host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header X-Forwarded-Host $server_name;\n        proxy_http_version 1.1;\n        proxy_set_header X-Forwarded-Ssl on;\n        proxy_buffering off;\n        proxy_set_header Connection \"\";\n    }\n\n    location \/v2\/hosted {\n        proxy_pass http:\/\/localhost:8087;\n        proxy_set_header Host $http_host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header X-Forwarded-Host $server_name;\n        proxy_http_version 1.1;\n        proxy_set_header X-Forwarded-Ssl on;\n        proxy_buffering off;\n        proxy_set_header Connection \"\";\n    }\n  }\n}\nEOF\n\n# Test NGINX configuration and reload\nsudo nginx -t && sudo systemctl reload nginx\n","script_type":"sh","command_line_args":"","exit_status":[],"login_credential_local_reference":{"name":"nutanix","kind":"app_credential"}},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"CALL_RUNBOOK","name":"VM Restart","description":"","attrs":{"type":"CALL_RUNBOOK","runbook_reference":{"name":"SYS_GEN__substrate__Registry_VM__action_restart__runbook","kind":"app_runbook"},"inarg_list":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"OSS_Config","description":"","attrs":{"type":"","script":"wget @@{nexus_location}@@\ntar -zxvf nexus-3.82.0-08-linux-x86_64.tar.gz\nsudo mkdir -p \/opt\/nexus \nsudo mv nexus-3.82.0-08 \/opt\/nexus\/\ncd \/opt\/nexus\nsudo ln -s nexus-3.82.0-08\/bin\/nexus nexus\nsudo adduser nexus && \\\nsudo chown nexus:nexus \/opt\/nexus","script_type":"sh","command_line_args":"","exit_status":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]},{"type":"EXEC","name":"OSS service","description":"","attrs":{"type":"","script":"#!\/bin\/bash\n\nSERVICE_FILE=\"\/etc\/systemd\/system\/nexus.service\"\n\nsudo bash -c \"cat > $SERVICE_FILE\" <<EOF\n[Unit]\nDescription=nexus service\nAfter=network.target\n\n[Service]\nType=forking\nExecStart=\/opt\/nexus\/nexus start\nExecStop=\/opt\/nexus\/nexus stop\nLimitNOFILE=65536\nUser=nexus\nRestart=on-abort\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\n# Reload systemd to pick up new service\nsudo systemctl daemon-reexec\nsudo systemctl daemon-reload\n\n# Enable nexus to start on boot\nsudo systemctl enable nexus.service\n\n# Start the service\nsudo systemctl start nexus.service\n\n# Show status\nsudo systemctl status nexus.service --no-pager\n\n","script_type":"sh","command_line_args":"","exit_status":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"3b7775ef_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"system","name":"action_delete","description":"System action for deleting an application. Deletes created VMs as well","runbook":{"name":"d98d7544_runbook","description":"","task_definition_list":[{"type":"DAG","name":"023240c2_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"023240c2_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"system","name":"action_start","description":"System action for starting an application","runbook":{"name":"32f8ad59_runbook","description":"","task_definition_list":[{"type":"DAG","name":"b5f9046c_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"b5f9046c_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"system","name":"action_stop","description":"System action for stopping an application","runbook":{"name":"aaa8d189_runbook","description":"","task_definition_list":[{"type":"DAG","name":"53ffa580_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"53ffa580_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"system","name":"action_restart","description":"System action for restarting an application","runbook":{"name":"7703800b_runbook","description":"","task_definition_list":[{"type":"DAG","name":"8d7de353_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Registry","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"8d7de353_dag","kind":"app_task"},"variable_list":[]},"critical":false}],"depends_on_list":[{"kind":"app_service","name":"Mirror"}],"port_list":[],"singleton":false,"tier":""}],"published_service_definition_list":[],"substrate_definition_list":[{"type":"AHV_VM","name":"Mirror_VM","description":"","variable_list":[],"action_list":[],"create_spec":{"type":"","name":"apr-Mirror-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"cluster_reference":{"type":"","kind":"cluster","name":"PHX-SPOC016-2","uuid":"00063aac-cdd3-b908-3b78-ac1f6b6033b5"},"resources":{"type":"","nic_list":[{"type":"","nic_type":"NORMAL_NIC","subnet_reference":{"type":"","kind":"subnet","name":"","uuid":"837f8dd2-52d5-4dde-8c24-4dd2b6151084"},"network_function_nic_type":"INGRESS","mac_address":"","ip_endpoint_list":[],"network_function_chain_reference":null,"vpc_reference":null}],"power_state":"ON","guest_tools":null,"num_vcpus_per_socket":2,"num_sockets":2,"memory_size_mib":8192,"gpu_list":[],"parent_reference":null,"hardware_clock_timezone":"","account_uuid":"5009300e-2f4f-493c-920b-a79649c72f54","guest_customization":{"type":"","cloud_init":{"type":"","meta_data":"","user_data":"#cloud-config\nusers:\n  - name: nutanix\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\nchpasswd:\n  list: |\n    nutanix:@@{nutanix.secret}@@\n  expire: False\nssh_pwauth:   true"},"sysprep":null},"boot_config":{"type":"","boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"mac_address":"","boot_type":"LEGACY"},"vtpm_config":null,"disk_list":[{"type":"","data_source_reference":{"type":"","kind":"image","name":"Rocky-9-GenericCloud-Base.latest.x86_64.qcow2","uuid":"d4513c1a-dd0c-482a-91a5-1f0967f3b05e"},"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"},"disk_size_mib":204800}],"serial_port_list":[]},"categories":{}},"os_type":"Linux","readiness_probe":{"login_credential_local_reference":{"name":"nutanix","kind":"app_credential"},"connection_type":"SSH","connection_port":22,"delay_secs":"0","retries":"5","address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","disable_readiness_probe":false,"connection_protocol":""}},{"type":"AHV_VM","name":"Registry_VM","description":"","variable_list":[],"action_list":[],"create_spec":{"type":"","name":"apr-Registry-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"cluster_reference":{"type":"","kind":"cluster","name":"PHX-SPOC016-2","uuid":"00063aac-cdd3-b908-3b78-ac1f6b6033b5"},"resources":{"type":"","nic_list":[{"type":"","nic_type":"NORMAL_NIC","subnet_reference":{"type":"","kind":"subnet","name":"","uuid":"837f8dd2-52d5-4dde-8c24-4dd2b6151084"},"network_function_nic_type":"INGRESS","mac_address":"","ip_endpoint_list":[],"network_function_chain_reference":null,"vpc_reference":null}],"power_state":"ON","guest_tools":null,"num_vcpus_per_socket":2,"num_sockets":2,"memory_size_mib":8192,"gpu_list":[],"parent_reference":null,"hardware_clock_timezone":"","account_uuid":"5009300e-2f4f-493c-920b-a79649c72f54","guest_customization":{"type":"","cloud_init":{"type":"","meta_data":"","user_data":"#cloud-config\nusers:\n  - name: nutanix\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\nchpasswd:\n  list: |\n    nutanix:@@{nutanix.secret}@@\n  expire: False\nssh_pwauth:   true"},"sysprep":null},"boot_config":{"type":"","boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"mac_address":"","boot_type":"LEGACY"},"vtpm_config":null,"disk_list":[{"type":"","data_source_reference":{"type":"","kind":"image","name":"Rocky-9-GenericCloud-Base.latest.x86_64.qcow2","uuid":"d4513c1a-dd0c-482a-91a5-1f0967f3b05e"},"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"},"disk_size_mib":204800}],"serial_port_list":[]},"categories":{}},"os_type":"Linux","readiness_probe":{"login_credential_local_reference":{"name":"nutanix","kind":"app_credential"},"connection_type":"SSH","connection_port":22,"delay_secs":"0","retries":"5","address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","disable_readiness_probe":false,"connection_protocol":""}}],"package_definition_list":[{"type":"DEB","name":"Install","description":"","variable_list":[],"action_list":[],"service_local_reference_list":[{"name":"Mirror","kind":"app_service"}],"version":"","options":{"type":"","install_runbook":{"name":"448df5b5_runbook","description":"","task_definition_list":[{"type":"DAG","name":"11dcc6ac_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Install","kind":"app_package"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"11dcc6ac_dag","kind":"app_task"},"variable_list":[]},"uninstall_runbook":{"name":"e833105c_runbook","description":"","task_definition_list":[{"type":"DAG","name":"a9034d71_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Install","kind":"app_package"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"a9034d71_dag","kind":"app_task"},"variable_list":[]},"upgrade_runbook":{}}},{"type":"DEB","name":"Package2","description":"","variable_list":[],"action_list":[],"service_local_reference_list":[{"name":"Registry","kind":"app_service"}],"version":"","options":{"type":"","install_runbook":{"name":"3a4bf3b5_runbook","description":"","task_definition_list":[{"type":"DAG","name":"cc1748c6_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Package2","kind":"app_package"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"cc1748c6_dag","kind":"app_task"},"variable_list":[]},"uninstall_runbook":{"name":"a69454ee_runbook","description":"","task_definition_list":[{"type":"DAG","name":"166c2a52_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Package2","kind":"app_package"},"timeout_secs":"0","retries":"0","inherit_target":false,"status_map_list":[]}],"main_task_local_reference":{"name":"166c2a52_dag","kind":"app_task"},"variable_list":[]},"upgrade_runbook":{}}}],"app_profile_list":[{"name":"Default","description":"","variable_list":[{"type":"LOCAL","name":"Domain_Name","description":"","options":{"type":"PREDEFINED","choices":[]},"is_hidden":false,"is_mandatory":true,"data_type":"BASE","val_type":"STRING","label":"","attrs":{"type":""},"editables":{"value":true},"value":"arief.com"},{"type":"LOCAL","name":"nexus_location","description":"","options":{"type":"PREDEFINED","choices":[]},"is_hidden":false,"is_mandatory":true,"data_type":"BASE","val_type":"STRING","label":"","attrs":{"type":""},"editables":{"value":true},"value":"http:\/\/10.38.16.73\/nexus-3.82.0-08-linux-x86_64.tar.gz"}],"action_list":[],"deployment_create_list":[{"type":"GREENFIELD","name":"deployment_12e442af","description":"","variable_list":[],"action_list":[],"depends_on_list":[],"min_replicas":"1","max_replicas":"1","default_replicas":"1","package_local_reference_list":[{"name":"Install","kind":"app_package"}],"substrate_local_reference":{"name":"Mirror_VM","kind":"app_substrate"},"published_service_local_reference_list":[]},{"type":"GREENFIELD","name":"deployment_6243fa38","description":"","variable_list":[],"action_list":[],"depends_on_list":[],"min_replicas":"1","max_replicas":"1","default_replicas":"1","package_local_reference_list":[{"name":"Package2","kind":"app_package"}],"substrate_local_reference":{"name":"Registry_VM","kind":"app_substrate"},"published_service_local_reference_list":[]}],"snapshot_config_list":[],"restore_config_list":[],"environment_reference_list":[],"application_url":"","patch_list":[]}],"credential_definition_list":[{"type":"PASSWORD","name":"nutanix","description":"","username":"nutanix","secret":{"attrs":{"secret_reference":{},"is_secret_modified":true},"value":"iXJEYMidADPhde3321WMMx3Z7r7kn9GReH96mo+XPthhOPc6rBnmdt4H:utf-8"},"cred_class":"static"},{"type":"PASSWORD","name":"admin","description":"","username":"admin","secret":{"attrs":{"secret_reference":{},"is_secret_modified":true},"value":"7kHOMc8zsR4GEffOPx6MAXUZfRiRtymXuuKIbiv+ilSwoNF+pLbod+8I:utf-8"},"cred_class":"static"}],"default_credential_local_reference":{"name":"nutanix","kind":"app_credential"},"type":"USER","client_attrs":{"deployment_12e442af":{"x":431,"y":315},"deployment_6243fa38":{"x":264.21835405072613,"y":445.54904706638683}}}},"api_version":"3.0","product_version":"4.1.0","metadata":{"last_update_time":"1753405175060521","creation_time":"1753397369203605","spec_version":6,"name":"Private_Mirror","kind":"blueprint"},"contains_secrets":true}